# 사내 통합 게시판 시스템 요구사항 정리

본 문서는 지금까지 사용자 프롬프트로 요청된 요구사항을 통합 정리한 문서이다.

## 1. 프로젝트 목표

- 첨부된 디자인 샘플(`design_sample/...`)을 참고해 사내 인트라넷형 통합 게시판 시스템 구축
- 대상 도메인:
  - 공지(Notice)
  - 자유게시판(Free Board)
  - 자료실(Library)
  - Q&A
  - 관리자 콘솔(Admin Console)

## 2. 기술 스택 요구사항

- Frontend:
  - Next.js
  - TypeScript
  - TailwindCSS
  - shadcn/ui
- Backend:
  - FastAPI
  - Pydantic
  - SQLModel
  - SQLite

## 3. 초기 핵심 기능 요구사항

### 3.1 인증/인가

- JWT 로그인: `POST /api/auth/login`
- 내정보 조회: `GET /api/auth/me`
- RBAC 역할:
  - `ADMIN`
  - `MANAGER`
  - `USER`
- 게시판별 권한:
  - `readRoles`
  - `writeRoles`

### 3.2 관리자 기능

- 게시판 관리:
  - 게시판 CRUD
  - 비활성화 지원
- 메뉴 관리:
  - 메뉴 CRUD
  - 정렬(sort) 관리
- 회원 관리:
  - 회원 검색
  - 권한 변경
  - 잠금(lock)
- 권한 관리:
  - 역할/권한 매트릭스

### 3.3 게시글/댓글/첨부

- 게시글 CRUD
  - 소프트 삭제
  - 조회수
  - 공지 고정(`isPinned`)
- Q&A 상태:
  - `qnaStatus`
  - 답변 완료 표시
- 댓글 CRUD
  - 작성자/관리자만 수정·삭제 가능
- 첨부 업로드/다운로드
  - `multipart`
  - 로컬 저장
  - 메타 DB 저장

### 3.4 검색

- 검색/필터/정렬/페이지네이션 지원

## 4. 프론트 라우팅 요구사항

- `/login`
- `/dashboard`
- `/boards/[boardId]`
- `/boards/[boardId]/posts/new`
- `/boards/[boardId]/posts/[postId]`
- `/admin/boards`
- `/admin/menus`
- `/admin/users`
- `/admin/roles`

## 5. 산출물 요구사항

- 실행 가능한 프론트/백엔드 전체 코드
- sqlite 초기화/seed
  - admin 계정
  - 기본 게시판 4개
  - 기본 메뉴
- README 실행방법 + 환경변수 문서화
  - `JWT_SECRET`
  - `UPLOAD_DIR`
  - `CORS_ORIGINS`

## 6. 이후 추가/변경 요구사항 (프롬프트 반영)

### 6.1 인증/데이터 확장

- 회원가입 기능 추가
- 테스트 회원 5명 생성
- 각 테스트 회원별 게시글 10개 작성(시드)

### 6.2 메뉴/레이아웃/UI 개선

- 좌측 메뉴 상단(인트라넷 영역)과 우측 상단 검색 패널 높이 일치
- 메뉴 클릭 시 사이드바 깜빡임 제거(메인만 자연스럽게 전환)
- 모바일에서 메뉴가 사라지는 현상 수정
- 메뉴 축소 기능 추가(축소 시 아이콘만 표시)
- 카테고리(`MENU`, `MANAGEMENT`) 고정 구조 제거
  - 카테고리 추가/삭제 가능
  - 카테고리 접기/펼치기 가능
- 카테고리 하위 메뉴 들여쓰기(계층 표현)
- 메뉴 여닫힘 애니메이션 부드럽게 처리
- 메뉴 클릭 시 콘텐츠 전환 페이드 효과 적용

### 6.3 관리자 메뉴 구조 정책

- `Admin Console` 외 `Menu Management`, `Member Management`, `Role Management` 노출 문제 수정
- 메뉴관리/멤버관리/권한관리 하드코딩 제거
  - 메뉴 관리 화면에서 관리 가능하도록 변경
  - 시드에도 포함

### 6.4 게시판 기능 확장/정책

- 좋아요 기능 추가
- 목록에 좋아요 수/댓글 수 표시
- 게시판 컬럼 사이즈 최적화
  - 좋아요/리플/조회 컬럼 폭 축소
  - 작성자/등록시간 컬럼 최적화
- 핀/오픈/답변 상태를 제목 옆에 표시
- 공지 pin 기능은 `ADMIN/MANAGER`만 가능하도록 제한
- 핀 표시 시인성 개선(화이트모드에서 잘 보이도록 색상 개선)
- 조회수가 클릭 1회에 여러 번 증가하는 버그 수정(1씩 증가 보장)

### 6.5 다크모드

- 첨부 다크모드 샘플(`design_sample/dark_mode/code.html`) 색상 참조 적용
- 다크모드 토글 스위치 추가

### 6.6 피드백/알림

- 저장/삭제 시 토스트 메시지 표시
  - “저장되었습니다.”
  - “삭제되었습니다.”

### 6.7 아이콘 관리 요구

- 메뉴 아이콘으로 사용 가능한 목록 안내
- 다른 아이콘 추가 방법 안내
- `lucide-react` 자주 사용하는 아이콘 목록 사전 등록

### 6.8 카테고리 삭제 정책

- 카테고리 삭제 시 `inactive` 처리 대신 실제 삭제(hard delete)
- 삭제 전 사용 여부 점검
  - 사용 중이면 삭제 차단
  - 경고 문구: `사용중이라 삭제할 수 없습니다.`

## 7. 안정성/오류 대응 요구사항

- 백엔드 실행 중 `ModuleNotFoundError: No module named 'sqlmodel'` 이슈 대응
- 프론트 Hydration mismatch 오류 대응
- 카테고리 추가 시 발생한 모듈 에러(`MODULE_NOT_FOUND`) 수정

## 8. 현재 문서화/유지보수 요구사항

- `README.md` 및 `AGENTS.md` 최신 상태 업데이트
- 요구사항 이력 문서(`requirement.md`) 생성 및 관리

## 9. 최종 수용 기준(요약)

- 기능:
  - 인증/인가, 게시판/댓글/첨부/좋아요/Q&A, 관리자 콘솔 동작
- 정책:
  - RBAC 및 게시판별 권한, pin 권한 제한, 카테고리 삭제 정책 적용
- UI/UX:
  - 모바일/데스크톱 메뉴 정상 동작, 축소/펼침/페이드/토스트/다크모드 적용
- 데이터:
  - seed 데이터(관리자/테스트유저/기본게시판/기본메뉴/테스트게시글) 정상 생성
- 문서:
  - 실행 방법, 환경변수, 운영 정책, 요구사항 이력 최신화
